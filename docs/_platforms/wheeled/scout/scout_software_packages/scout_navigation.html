

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Scout Navigation Respositry &mdash; Weston Robot V0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Scout Base Respositry" href="scout_base.html" />
    <link rel="prev" title="Scout Mobile Robot" href="../scout.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #323640" >
          

          
            <a href="../../../../index.html">
          

          
            
            <img src="../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../_general/mobile_robot_system.html">Overview of Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_general/operational_safety.html">Operational Safety</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_general/robot_maintenance.html">Robot Maintenance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../_general/robot_maintenance.html#battery">Battery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../_general/robot_maintenance.html#tire">Tire</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_general/software_packages.html">Overview of Software Packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../_general/software_packages.html#repository-naming">Repository Naming</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../scout.html">Scout Mobile Robot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#software-developemnt-kits">Software Developemnt Kits</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../scout.html#scout-base-respositry">Scout Base Respositry</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../scout.html#scout-base-package">scout_base package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#scout-description-package">scout_description package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#scout-msgs-package">scout_msgs package</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../scout.html#scout-bringup-package">scout_bringup package</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../scout.html#scout-navigation-respositry">Scout Navigation Respositry</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../scout.html#repository-set-up">Repository Set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#scout-webots-sim-packages"><em>scout_webots_sim</em> packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#sample-development">Sample Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#simulation-specifications">4. Simulation Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#running-simulation">5. Running Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#running-mapping">6. Running Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#saving-and-loading-of-maps">7. Saving and Loading of maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#scout-nav-bringup">8. scout_nav_bringup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scout.html#custom-development">Custom Development</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../scout.html#robot-setup">3. Robot Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hunter/hunter.html">Hunter Mobile Robot</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tracked/bunker.html">Bunker Mobile Robot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tracked/bunker.html#basic-operations">Basic Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tracked/bunker.html#ros-interface">ROS Interface</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../legged/a1.html">Basic Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../legged/aliengo.html">Aliengo Robot Dog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Weston Robot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../scout.html">Scout Mobile Robot</a> &raquo;</li>
        
      <li>Scout Navigation Respositry</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/_platforms/wheeled/scout/scout_software_packages/scout_navigation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="scout-navigation-respositry">
<h1>Scout Navigation Respositry<a class="headerlink" href="#scout-navigation-respositry" title="Permalink to this headline">¶</a></h1>
<p>This repository contains navigation and simulation packages for scout robot.</p>
<ul class="simple">
<li>scout_nav_platform: a demostrational navigation platform with lidar and IMU</li>
<li>scout_ros_nav: a demonstrational ROS navigation setup for scout</li>
<li>scout_webots_sim: webots-based simulation support for scout</li>
</ul>
<div class="section" id="repository-set-up">
<h2>Repository Set up<a class="headerlink" href="#repository-set-up" title="Permalink to this headline">¶</a></h2>
<p>Please setup “[scout_base](<a class="reference external" href="https://github.com/westonrobot/scout_base.git">https://github.com/westonrobot/scout_base.git</a>)” repository properly before proceeding to the following steps.</p>
<div class="section" id="install-depednent-libraries">
<h3>1. Install Depednent libraries<a class="headerlink" href="#install-depednent-libraries" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install -y ros-$ROS_DISTRO-ros-controllers \
                      ros-$ROS_DISTRO-joint-state-publisher-gui \
                      ros-$ROS_DISTRO-navigation \
                      ros-$ROS_DISTRO-teb-local-planner \
                      ros-$ROS_DISTRO-gmapping \
                      ros-$ROS_DISTRO-pointcloud-to-laserscan \
                      ros-$ROS_DISTRO-pcl-ros \
                      ros-$ROS_DISTRO-webots-ros
                      ros-$ROS_DISTRO-teleop-twist-keyboard
</pre></div>
</div>
</div>
<div class="section" id="clone-the-packages-into-your-catkin-workspace-and-compile">
<h3>2. Clone the packages into your catkin workspace and compile<a class="headerlink" href="#clone-the-packages-into-your-catkin-workspace-and-compile" title="Permalink to this headline">¶</a></h3>
<p>(the following instructions assume your catkin workspace with scout_base and ugv_sdk is at: ~/catkin_ws/src)
.. code-block:: none</p>
<blockquote>
<div>$ cd ~/catkin_ws/src
$ git clone <a class="reference external" href="https://github.com/westonrobot/scout_navigation.git">https://github.com/westonrobot/scout_navigation.git</a>
$ cd ..
$ catkin_make</div></blockquote>
</div>
</div>
<div class="section" id="scout-webots-sim-packages">
<h2><em>scout_webots_sim</em> packages<a class="headerlink" href="#scout-webots-sim-packages" title="Permalink to this headline">¶</a></h2>
<p>This package provides the tools for a high level interface with the Scout platform in the Webots simulated environment. The tools provided are mainly:</p>
<ol class="arabic simple">
<li>A simulated world with the Scout model loaded inside</li>
<li>A ROS node that interfaces between ROS and the Scout model in Webots</li>
<li>SDK for adding peripheral to the Scout model in Webots.</li>
</ol>
<ul>
<li><dl class="first docutils">
<dt>Start the Webots-based simulation of the Scout platform:</dt>
<dd><div class="first highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_webots_sim scout_v2_sim_basic.launch
</pre></div>
</div>
<p class="last">This will:
1. Launch Webots
2. Load a simple world with the scout robot in it</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Next, the ROS node interfaces ROS with the Scout model in Webots can be launched:</dt>
<dd><div class="first highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_webots_sim scout_v2_sim_node_basic
</pre></div>
</div>
<p>In the Webots console, the message <em>The controller is now connected to the ROS master</em> should be displayed.</p>
<p>This will start the <em>/scout_webots_node</em> that</p>
<ul class="simple">
<li>Subscribes:<ul>
<li>/cmd_vel</li>
<li>/scout_light _control</li>
<li>/model_name</li>
</ul>
</li>
<li>Publishes:<ul>
<li>/odom</li>
<li>/tf</li>
</ul>
</li>
</ul>
<p class="last">Through this node, the Scout model can be controller using the /cmd_vel topic.</p>
</dd>
</dl>
</li>
<li><p class="first">Start the keyboard tele-op node</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_bringup scout_teleop_keyboard.launch
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>In the <em>scout_nav_bringup</em> the launch file: <em>scout_sim_basic_full.launch</em> will launch all 3 launch files above as well as the <em>/tf</em> node.</p>
</div>
<div class="section" id="sample-development">
<h2>Sample Development<a class="headerlink" href="#sample-development" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>A sample development of the Scout platform, for navigation and mapping is provided in</dt>
<dd><em>scout_nav_platform</em>. This package will be elaborated on in this segment.</dd>
</dl>
<div class="section" id="hardware-specifications">
<h3>1. Hardware Specifications<a class="headerlink" href="#hardware-specifications" title="Permalink to this headline">¶</a></h3>
<p>The hardware attached to the Scout robot are:</p>
<ol class="arabic simple">
<li>Metal Frame</li>
<li>Power Distribution Board (PDB)</li>
<li>Onboard Computer: Jetson Xavier NX</li>
<li>Onboard Router: Asus RT - N56U</li>
<li>3D Lidar: (LS 16-Channel LiDAR (Compact)](<a class="reference external" href="http://www.lslidar.com/product/leida/MX/33802ac6-f05e-4818-ac95-f73b84e99131.html">http://www.lslidar.com/product/leida/MX/33802ac6-f05e-4818-ac95-f73b84e99131.html</a>)</li>
</ol>
<p>A seperate PC will be connected wirelessly to the onbaord system.This PC will be refered to as the <em>workstation</em>.</p>
<p>Through the CAN interface on the Scout robot, the power is routed to the PDB and distributed to the onboard computer, router and LiDAR.</p>
<p>The onboard computer is also connected to the CAN bus via the CAN interface on the Scout. The onboard computer thus sends the steering commands to the in-build micro-controller in the Scout.</p>
<p>The LiDAR used can only transmit data through ethernet protocol. The router is used to connect the LiDAR, the onboard computer and the workstation.</p>
</div>
<div class="section" id="software-specifications">
<h3>2. Software Specifications<a class="headerlink" href="#software-specifications" title="Permalink to this headline">¶</a></h3>
<p>The onboard computer is running Ubuntu 18.04 with ROS Melodic.</p>
<ul>
<li><p class="first">IP Adresses:</p>
<blockquote>
<div><ul class="simple">
<li>work station: 10.10.0.150</li>
<li>onboard computer: 10.10.0.10</li>
<li>lsLiDAR: 10.10.0.30</li>
</ul>
<p>The IP address of the work station and onboard computer were set using DHCP on the router, while the lsLiDAR IP address wast set statically using a customised software for lsLiDAR</p>
</div></blockquote>
</li>
<li><p class="first">ROS packages</p>
<ul class="simple">
<li>[lslidar](<a class="reference external" href="https://github.com/pd-tan/lslidar_C16.git">https://github.com/pd-tan/lslidar_C16.git</a>) package was used to publish the LiDAR data as a ROS topic.</li>
<li>[scout_base](<a class="reference external" href="https://github.com/westonrobot/scout_base.git">https://github.com/westonrobot/scout_base.git</a>) package was used to interface between ROS topics and CAN messages sent through the CAN bus.</li>
<li>[scout_webots_sim](./scout_webots_sim) package was used to implements a Webots simulation of the navigation platform.</li>
<li><cite>ROS navigation stack</cite> was used for mapping and navigation. gmapping was used for mapping while amcl was used for localization.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="running-actual-robot">
<h3>3. Running Actual Robot<a class="headerlink" href="#running-actual-robot" title="Permalink to this headline">¶</a></h3>
<p>Unless stated otherwise, all commands are to be run from the onbaord computer
Ensure that the workstation is connected to the router on the Scout robot.</p>
<ol class="arabic">
<li><p class="first">Setup ROS network</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ source ~/catkin_ws/scout_navigation/scout_platform/scripts/ros_network_onboard_setup.bash
</pre></div>
</div>
<p>On the workstation:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ source ~/catkin_ws/scout_navigation/scout_platform/scripts/ros_network_workstation_setup.bash
</pre></div>
</div>
<p>This setup must be run in every terminal instance used for ROS on both the workstation and the onboard computer. Consider adding these commands to ~/.bashrc to simplify setup.</p>
<p>To test that the ROS network is setup appropriately:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roscore
</pre></div>
</div>
<p>On the workstation:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ rostopic list
</pre></div>
</div>
<p>If the terminal on the workstation is able to find the instance of ROS started on the onboard computer, the following should be returned on the workstation:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/rosout
/rosout_agg
</pre></div>
</div>
<p>Ensure that no instance of ROS in running on the workstation prior to these tests.</p>
<p>More information about ROS network can be found online.</p>
</div></blockquote>
</li>
<li><p class="first">Start Communication between Scout and Onboard PC</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_base scout_base.launch
</pre></div>
</div>
<p>To test this communication, on the workstation</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_bringup scout_teleop_keyboard.launch
</pre></div>
</div>
<p>from the workstation, the scout platform should be able to be controlled using the keyboard.</p>
<p>Take note to suspend the Scout robot, ensuring that the wheels are not in contact with ground to prevent the robot from actually moving.</p>
<p>More information about the communication between the onboard pc and scout can be found in [scout_base](<a class="reference external" href="https://github.com/westonrobot/scout_base.git">https://github.com/westonrobot/scout_base.git</a>)</p>
</div></blockquote>
</li>
<li><p class="first">Start Communication with LiDAR</p>
<blockquote>
<div><p>Since a lsLiDAR is used for this platform, the ROS package developed for lsLiDAR is used.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch lslidar_c16_decoder lslidar_c16.launch
</pre></div>
</div>
<p>To test that the node was launched successfully:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rostopic list
</pre></div>
</div>
<p>The topics <em>/lslidar_packet</em>, <em>/lslidar_point_cloud</em> and <em>/lslidar_sweep</em> should be listed out.</p>
</div></blockquote>
</li>
</ol>
</div>
</div>
<div class="section" id="simulation-specifications">
<h2>4. Simulation Specifications<a class="headerlink" href="#simulation-specifications" title="Permalink to this headline">¶</a></h2>
<p>The simulation should be run on the workstation and NOT the onboard computer</p>
<div class="section" id="webots-extensions">
<h3>Webots Extensions<a class="headerlink" href="#webots-extensions" title="Permalink to this headline">¶</a></h3>
<p>The ROS [scout_nav_sim_node](./scout_nav_platfom/src/scout_nav_sim_node.cpp) written for this navigation platform implements the [WebotsRunner](./scout_webots_sim/src/scout_webots_runner.cpp) class from the scout_webots_sim package.</p>
<p>Two extensions were implemented in C++ [imu_extension](./scout_nav_platform/src/imu_extension.cpp) and [lidar_extension](./scout_nav_platform/src/lidar_extension.cpp). These two extensions were added to the instance of WebotsRunner to interface ROS with the LiDAR and IMU in Webots. The two extensions act as an interface between ROS and the extension in webots,</p>
</div>
</div>
<div class="section" id="running-simulation">
<h2>5. Running Simulation<a class="headerlink" href="#running-simulation" title="Permalink to this headline">¶</a></h2>
<p>To run the base instance of the simulation (with the platform and LiDAR, but no mapping or navigation running):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_nav_platoform scout_v2_sim_nav_platform
</pre></div>
</div>
<p>The robot model loaded from this launch file will have the LiDAR attached to the model (floating above the scout model). Furthermore, the robot model will be loaded into an indoor house environment.</p>
<p>Compared to the scout_v2_sim_node_basic.launch, the ROS node created from this scout_v2_sim_nav_platform.launch file publishes the additional topics of:
1. /imu
2. /rslidar_points</p>
<p>These additional topics are published as a result of [imu_extension](./scout_nav_platform/src/imu_extension.cpp) and [lidar_extension](./scout_nav_platform/src/lidar_extension.cpp).</p>
</div>
<div class="section" id="running-mapping">
<h2>6. Running Mapping<a class="headerlink" href="#running-mapping" title="Permalink to this headline">¶</a></h2>
<p>Regardless of wether the simulation or the actual robot is used, the following steps for running mapping are the same.</p>
<p>For the simulation, the command are all run on the workstation.</p>
<p>For the actual robot, commands are run on the onboard computer, unless otherwise stated</p>
<ol class="arabic">
<li><p class="first">Launch Description</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_nav_platform scout_v2_nav_platform_description.launch
</pre></div>
</div>
<p>This will publish the transforms between the different links of the robot as well as the odom and map link</p>
</div></blockquote>
</li>
<li><p class="first">Visualize on Workstation</p>
<blockquote>
<div><p>The data obtained from the LiDAR, as well as the transforms, can be visualised in RVIZ.</p>
<p>On the workstation:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ rosrun rviz rviz
</pre></div>
</div>
<p>Add the folllowing:</p>
<ol class="arabic simple">
<li>pointcloud</li>
<li>tf</li>
</ol>
<p>If all the above steps were executed without issue, the pointcloud obtained from the LiDAR will be seen on RVIZ.</p>
</div></blockquote>
</li>
<li><p class="first">Run mapping</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_ros_nav scout_v2_mapping.launch
</pre></div>
</div>
<p>The map can be visualized on RVIZ by adding the <cite>map</cite> and selecting the map topic.</p>
<p>To obtain an appropriate map of the surrounding, the Scout has to be moved around. The Scout robot can be controlled from the workstation using:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ roslaunch scout_bringup scout_teleop_keyboard.launch
</pre></div>
</div>
<p>As the Scout is moving around, a map of its surrounding will be obtained and displayed on RVIZ</p>
</li>
</ol>
</div>
<div class="section" id="saving-and-loading-of-maps">
<h2>7. Saving and Loading of maps<a class="headerlink" href="#saving-and-loading-of-maps" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">To save the map generated from mapping:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ rosrun map_server map_saver -f {YOUR_CATKIN_WORKSPACE}/src/scout_navigation/scout_ros_nav/maps/{YOUR_MAP_NAME}
</pre></div>
</div>
<p>The map_server should be run after the map obtained is satisfactory and can be be used for navigation. The map will be saved as YOUR_MAP_NAME.yaml and YOUR_MAP_NAME.pgm</p>
</div></blockquote>
</li>
<li><p class="first">To select the .yaml map file, edit the map_file value in the launch file (scout_v2_sim_navigation.launch or scout_v2_robot_navigation.launch)</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;arg name=&quot;map_file&quot; default=&quot;$(find scout_ros_nav)/maps/webots_indoor.yaml&quot;/&gt;
</pre></div>
</div>
<p>should be changed to</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;arg name=&quot;map_file&quot; default=&quot;${YOUR_CATKIN_WORKSPACE}/src/scout_navigation/scout_ros_nav/maps/{YOUR_MAP_NAME}.yaml&quot;/&gt;
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="scout-nav-bringup">
<h2>8. scout_nav_bringup<a class="headerlink" href="#scout-nav-bringup" title="Permalink to this headline">¶</a></h2>
<p>Form the previous instruction, multiple instances of the terminal would be required to launch all the individual launch files. The scout_nav_bringup package provides launch files that consolidate different launch files:</p>
<ol class="arabic simple">
<li>scout_v2_sim_nav_platform_full.launch:<ol class="arabic">
<li>Launches <cite>scout_v2_sim_nav_platform.launch</cite>: Runs Webots and start ROS node to interface LiDAR, IMU and Scout in webots with ROS</li>
<li>Launches <cite>scout_v2_nav_platform_description.launch</cite>: Publishes transformed between links in the robot</li>
<li>Launches <cite>scout_teleop_keyboard.launch</cite>: Control Scout in Webots using keyboard.</li>
<li>Runs <cite>pointcloud_to_laserscan</cite> node that condenses 3D pointcloud into 2D scan for gmapping</li>
</ol>
</li>
<li>scout_v2_sim_mapping.launch:<ol class="arabic">
<li>Launches <cite>scout_v2_sim_nav_platform_full.launch</cite></li>
<li>Launches <cite>scout_v2_mapping.launch</cite></li>
</ol>
</li>
<li>scout_v2_sim_navigation.launch:<ol class="arabic">
<li>Launches <cite>scout_v2_sim_nav_platform_full.launch</cite></li>
<li>Launches <cite>scout_v2_navigation.launch</cite></li>
</ol>
</li>
<li>scout_v2_robot_mapping.launch:
#. Launches <cite>scout_base.launch</cite>: Setup communication between onboard PC and Scout<ol class="arabic">
<li>Launches <cite>scout_v2_nav_platform_description.launch</cite>: Publishes transformed between links in the robot</li>
<li>Launches <cite>scout_v2_mapping.launch</cite></li>
</ol>
</li>
<li>scout_v2_robot_navigation.launch:<ol class="arabic">
<li>Launches <cite>scout_base.launch</cite>: Setup communication between onboard PC and Scout</li>
<li>Launches <cite>scout_v2_nav_platform_description.launch</cite>: Publishes transformed between links in the robot</li>
<li>Launches <cite>scout_v2_navigation.launch</cite></li>
</ol>
</li>
<li>scout_v2_workstation_mapping.launch<ol class="arabic">
<li>Runs RVIZ using a preset configuration to display pointcloud, laserscan, mapping and transforms</li>
</ol>
</li>
<li>scout_v2_workstation_navigation.launch<ol class="arabic">
<li>Runs RVIZ using a preset configuration to display pointcloud, laserscan, mapping and transforms</li>
</ol>
</li>
</ol>
<p>An example usage of these launch files is as described below:</p>
<ol class="arabic simple">
<li>launch scout_v2_robot_mapping.launch &amp; launch lslidar_c16.launch on the onboard pc</li>
<li>launch scout_v2_workstation_mapping.launch on the workstation.</li>
<li>launch scout_teleop_keyboard.launch to control the robot</li>
<li>Move the robot around and map the area it is in</li>
</ol>
</div>
<div class="section" id="custom-development">
<h2>Custom Development<a class="headerlink" href="#custom-development" title="Permalink to this headline">¶</a></h2>
<p>This sections outlines how you would get started on creating your own package for the scout platform with custom hardware extensions, such as a lidar and imu. This respository consist of the files required for both the simulation and the interface with the physical platform and sensors.</p>
<div class="section" id="package-and-directory-setup">
<h3>1. Package and Directory Setup<a class="headerlink" href="#package-and-directory-setup" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ catkin_create_package ${YOUR_PACKAGE_NAME} scout_webots_sim geometry_msgs message_generation pcl_ros roscpp roslaunch rospy scout_base sensor_msgs std_msgs tf webots_ros pointcloud_to_laserscan

$ cd ${YOUR_PACKAGE_DIRECTORY}

$ mkdir urdf rviz webots_setup
</pre></div>
</div>
</div>
<div class="section" id="simulation-setup">
<h3>2. Simulation Setup<a class="headerlink" href="#simulation-setup" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">New Webots Project</p>
<blockquote>
<div><ul class="simple">
<li>Launch webots</li>
<li>Create a new project directory in ${YOUR_PACKAGE_DIRECTORY}/webots_setup : Wizards – New Project Directory – Add a rectangle arena</li>
<li>Copy the scout_v2.proto into the ${YOUR_PACKAGE_DIRECTORY}/webots_setup/protos directory</li>
<li>Copy the scout_base_controller folder into the ${YOUR_PACKAGE_DIRECTORY}/webots_setup/</li>
<li>Import the scout robot by adding a proto node: add – PROTO nodes (Current Projects) – ScoutV2(robot) – add</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Setting up custom extensions</p>
<blockquote>
<div><p>Adding your own extension consists of 3 main steps:</p>
<ul class="simple">
<li>Adding extension in webots model</li>
<li>Adding the transforms for the extension in the .xacro file</li>
<li>Writing the C++ code to interface between the webots extension and ROS</li>
</ul>
<p>The example of adding a RPLIDAR module is explained in this example.</p>
</div></blockquote>
</li>
<li><p class="first">webots model</p>
<blockquote>
<div><ul class="simple">
<li>Under ScoutV2, select extensionSlot and click &lt;add&gt; to add your desired extension</li>
<li>Create folder “${YOUR_PACKAGE_DIRECTORY}/webots_setup/models”</li>
<li>Export model with extensions into the exported models folder</li>
<li>The exported model can now be imported into any world within the project.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">urdf/xacro model</p>
<blockquote>
<div><ul class="simple">
<li>Create a new .xacro file</li>
<li>Import the base .xacro file of the scout model using: <code class="docutils literal notranslate"><span class="pre">&lt;xacro:include</span> <span class="pre">filename=&quot;$(find</span> <span class="pre">scout_description)/urdf/scout_v2.xacro&quot;</span> <span class="pre">/&gt;</span></code></li>
<li>Add the links and joints of the new extension</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">ROS/webots interface</p>
<blockquote>
<div><ul class="simple">
<li>Create a class “ExtensionExample” that inherits the WebotsExtension class</li>
<li>Define the setup protocol as shown in [lidar_extension.cpp](scout_ros_nav/src/lidar_extension.cpp)</li>
<li>The purpose of this interface is to generate a node that calls the ROS services to interface with Webots. For example, the [lidar_extension.cpp](scout_ros_nav/src/lidar_extension.cpp) is used to generate a node that publishes the laser scan data from the lidar in the Webots simulation.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Exporting your new model to a different world</p>
<blockquote>
<div><p>Note: this is to export the model to a new world but within the same project.</p>
<p>After the robot and its additional sensors has been modeled in the webots world, it is like that you would like to place this robots in different simulated environments, such as a workshop space or an indoor apartment. This sections brief outlines the main steps involved</p>
<ul>
<li><p class="first">Export the new robot model (with extensions) using the webots GUI:</p>
<blockquote>
<div><ul class="simple">
<li>Right-click the model node</li>
<li>Click Export</li>
<li>Save the model in a the folder ${YOUR_PACKAGE_DIRECTORY}/simulation/exported models</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Load the world in webots you want to import the model into.</p>
</li>
<li><dl class="first docutils">
<dt>Add the export robot model</dt>
<dd><ul class="first last simple">
<li>Add node</li>
<li>Import…</li>
<li>Select the model file that you exported in step 1</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ol>
<p>Having finished the above steps, you should be able to see the scout platform with its extensions inside your chosen environment.</p>
</div>
</div>
<div class="section" id="robot-setup">
<h2>3. Robot Setup<a class="headerlink" href="#robot-setup" title="Permalink to this headline">¶</a></h2>
<p>If the hardware extensions, such as the type of LIDAR or camera, is already known/determined, the simulation should then be altered to closely follow the actual setup. For example:</p>
<ul class="simple">
<li>The location of sensors in the simulation should match the physical robot, so that the URDF files for both real and simulated robot are the same.</li>
<li>The nodes created for the different webots extensions should behave similarly to the actual hardware set-up so that the accompanying programs, such a mapping and navigation, can be used for both the simulation and the physical robot</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scout_base.html" class="btn btn-neutral float-right" title="Scout Base Respositry" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../scout.html" class="btn btn-neutral float-left" title="Scout Mobile Robot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Weston Robot Pte Ltd

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>